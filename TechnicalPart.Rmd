---
title: "Technical"
author: "Madeline Gorchels"
date: "4/23/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning=FALSE, message=FALSE}
library(tidyverse)
library(janitor)
library(scales)
gas_data <- read_csv("Gas_Data_Tidy.csv") %>% 
  clean_names()

```

Work divide: Whoever finishes 1-2 does 5-6, other person does 3-4 and starts the memo 

***Part 1: Aggregate Daily Demand Curve

*****Math to get aggreate demand curve (set equal to qantity so we are adding horizontally)
low_q = 145837.7 + -5202.5*p
high_q = 147030.6 + -3293.0*p

Qag = 292868.3 + -8495.5*p


P_ag = 34.47334 + Q/-8495.5

P_ag = 34.47334 - 


```{r}
#equation math 
147030.6 + 145837.7

-5202.5 +-3293.0

292868.3/8495.5

```


```{r}
#quick plot
high_con = gas_data %>% 
  filter(class == "Q_High_Gallons_per_Day")

#linear model for the high income gas users 

high_lm <- lm(quantity ~ price_dollars, data = high_con)


high_lm <- lm(quantity ~ price_dollars, data = high_con)

summary(high_lm)

low_con = gas_data %>% 
  filter(class != "Q_High_Gallons_per_Day")

#linear model for the low income gas users


low_lm <- lm(price_dollars ~ quantity, data =low_con)

supply <- function(q)((0.00001872*q))

msc <- function(q)((0.00001872*q)+ 2)

mec <- function(q)(2)
#aggregated demand curve equation
aggregate <- function(q)(22.6997 - (0.00006625*q))

demand_plot = ggplot(gas_data, aes(y = price_dollars, x = quantity))+
  theme_classic()+
  stat_function(fun = supply, size = 1, aes(colour = "Supply")) + #supply curve 
  stat_function(fun = aggregate, size = 1, aes(colour = "Aggregated Demand Curve")) + #aggregated demand curve
  stat_function(fun = msc, size = 1, aes(colour = "Marginal Social Cost")) + #marginal social cost (marginal willingness to pay)
  stat_function(fun = mec, size = 1, aes(colour = "Marginal External Cost"))+
  scale_x_continuous(limits = c(0,310000), expand = c(0,0), labels = comma) +
  scale_y_continuous(limits = c(0,25), expand = c(0,0)) +
  labs(x = "Quantity of Gas (Gallons)",
       y = "Price of Gas (U.S. Dollars)") +
  scale_colour_manual("legend title", values = c("Blue", "Green", "Purple", "Red"))
  
  
  

demand_plot
```

***Part 2: How is the current consumer benefit divided?
```{r}
#triangle area equation 
triangle_area_high <- function(height, Q) {
  p = 23.3914 - 0.0001297*Q
  area <- ((1/2*base)*height)
  return(area)
}



lowincome_mec <- 143837.64-1



Q_notax<-180350.0386


```

***Part 3: What are the effects of the 50 cent gas tax:
a. The amount of gasoline produced and sold in France.
b. The price of gasoline.
c. Welfare of “High” income consumers.
d. Welfare of “Low” income consumers.
e. Welfare of gas producers.
f. Total environmental damage.
g. Total revenue generated by the tax.

```{r}



```

